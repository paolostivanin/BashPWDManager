#!/bin/bash

#################################################################
# @Author: Paolo Stivanin aka Polslinux
# @Name: Bash Password Manager
# @Copyright: 2011
# @Site: http://www.polslinux.it
# @License: GNU AGPL v3 http://www.gnu.org/licenses/agpl.html
#################################################################

IFS=$'\n'
version="0.1-alpha2"

function check_db(){
database=`zenity --file-selection --title "Scegli percorso database"`
permission=`ls -l $database | cut -f2 -d'-'`
if [ ! -f $database ] || [ "$permission" != "rw" ]; then
echo "Il database non esiste oppure non ha i permessi read/write."
exit 1
fi
}

function input_info(){
username=`zenity --entry --title "Username" --text "Inserisci nome utente"`
password=`zenity --entry --hide-text --title "Password" --text "Inserisci password"`
echo $username >> $database
echo $password >> $database
echo "-------------------------------" >> $database
}

function fine_prog(){
unset username
unset password
unset IFS
}

if [ "$1" == "-v" ] ; then
echo "Bash Password Manager version $version"
exit 0
fi

check_db
input_info
fine_prog
